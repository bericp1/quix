"use strict";angular.module("quixApp",["ngCookies"]).config(["$routeProvider",function(t){t.when("/start",{templateUrl:"views/start.html",controller:"StartCtrl"}).when("/admin",{templateUrl:"views/admin.html",controller:"AdminCtrl"}).when("/question",{templateUrl:"views/question.html",controller:"QuestionCtrl"}).when("/answer",{templateUrl:"views/answer.html",controller:"AnswerCtrl"}).otherwise({redirectTo:"/start"})}]).directive("candystatus",function(){return{restrict:"C",replace:!0,scope:{status:"@"},templateUrl:"views/components/candystatus.html",link:function(t,e,n){(function(){})(t),function(){}(e),function(){}(n);var s=function(){$.get("/candystatus",{},function(t){$(e.get(0)).find("span").text(t.status)},"json")};window.setInterval(s,1e4),s()}}}).run(function(t){t.$on("$routeChangeSuccess",function(){window.textFillUpdate()}),t.$on("UpdateTextFill",function(){window.textFillUpdate()})}),angular.module("quixApp").controller("AdminCtrl",["$scope",function(t){t.password="",t.AddQuestionCtrl=["$scope",function(t){t.question="",t.a="",t.b="",t.c="",t.d="",t.correct="",t.status="Ready!",t.statusClass="text-info",t.enabled=!0,t.add=function(){t.statusClass="text-info",t.enabled=!1,$.get("/admin/addquestion",{password:t.password,question:t.question,a:t.a,b:t.b,c:t.c,d:t.d,correct:t.correct},function(e){e.ok?(t.statusClass="text-success",t.status="Add SUCCESS!",t.question="",t.a="",t.b="",t.c="",t.d="",t.correct=""):(t.statusClass="text-error",t.status="Add FAILED: "+e.err),t.enabled=!0,t.$apply()},"json")}}],t.CandyStatusCtrl=["$scope",function(t){t.newstatus="",t.status="Ready!",t.statusClass="text-info",t.enabled=!0,t.change=function(){t.enabled=!1,t.status="Changing...",t.statusClass="text-info",$.get("/admin/changecandystatus",{password:t.password,status:t.newstatus},function(e){e.ok?(t.newstatus="",t.status="Change SUCCESS!",t.statusClass="text-success"):(t.status="Change FAILED: "+e.err,t.statusClass="text-error",console.log(e.err)),t.enabled=!0,t.$apply()},"json")}}],t.QuestionReenableCtrl=["$scope",function(t){t.status="Ready!",t.statusClass="text-info",t.enabled=!0,t.reenable=function(){t.enabled=!1,t.status="Re-Enableing...",t.statusClass="text-info",$.get("/admin/reenablequestions",{password:t.password},function(e){e.ok?(t.newstatus="",t.status="Re-Enable SUCCESS!",t.statusClass="text-success"):(t.status="Re-Enable FAILED: "+e.err,t.statusClass="text-error",console.log(e.err)),t.enabled=!0,t.$apply()},"json")}}]}]),angular.module("quixApp").controller("StartCtrl",["$scope","$location",function(t,e){(function(){})(t),function(){}(e),t.goTo=function(t){e.path("/"+t)}}]),angular.module("quixApp").controller("QuestionCtrl",["$scope",function(t){t.currentQuestionId=-1,t.currentQuestionText="Loading next question...",t.answerTextA="",t.answerTextB="",t.answerTextC="",t.answerTextD="",t.loading=!0;var e=function(){$.get("/new_question",{},function(e){e.ok?(t.currentQuestionId=e.id,t.currentQuestionText=e.question,t.answerTextA=e.answers.A,t.answerTextB=e.answers.B,t.answerTextC=e.answers.C,t.answerTextD=e.answers.D,t.correct=e.answers.correct,t.loading=!1):(t.currentQuestionId=-1,t.currentQuestionText="Something went wrong.",e.humanErr&&(t.currentQuestionText=e.humanErr),t.answerTextA="",t.answerTextB="",t.answerTextC="",t.answerTextD="",t.correct="",t.loading=!1,console.log(e.err)),t.$apply()})};e();var n=50;Modernizr.touch&&(n=2e3),window.setInterval(function(){window.textFillUpdate()},n)}]),angular.module("quixApp").controller("AnswerCtrl",["$scope","$cookieStore","$window",function(t,e,n){(function(){})(t),t.ok=!0,t.status="Loading...",t.questionId=-1,t.correct="",t.state="loading",t.update=function(e){$.get("/current_question",{},function(n){n.ok?(t.ok=!0,t.questionId=n.id,t.correct=n.answers.correct):(t.ok=!1,t.questionId=-1,t.correct="",t.status="<br><h2>Something went wrong. Try refreshing.</h2>",n.humanErr&&(t.status="<h2>"+n.humanErr+'</h2><button class="btn btn-blk" onclick="window.location.reload();">Refresh</button>'),t.state="loading"),t.$apply(),e()})},t.update(function(){t.ok&&(e.get("hasPlayed")&&parseInt(e.get("hasPlayed"),10)===parseInt(t.questionId,10)?(t.state="loading",t.status='<h2>Wait until the next question.</h2><button class="btn btn-blk" onclick="window.location.reload();">Refresh</button>'):(t.$apply(function(){e.remove("hasPlayed")}),t.state="answers"),t.$apply())}),t.check=function(n){t.state="loading",t.update(function(){t.ok&&(t.correct.toLowerCase()===n.toLowerCase()?(t.state="winner",window.setTimeout(function(){t.$apply(function(){t.refresh()})},6e4)):t.state="loser",t.$apply(function(){e.put("hasPlayed",parseInt(t.questionId,10))}),t.$apply())})},t.refresh=function(){n.location.reload()}}]),window.textFillUpdate=function(t){var e=t||86;$(".textfill").each(function(t,n){$(n).textfill({maxFontPixels:e})})};